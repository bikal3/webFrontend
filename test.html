<!DOCTYPE HTML>
<html lang="en" dir="ltr">

<head>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

    <script>
        $(document).ready(function() {
            let imageName = '';
            $("#dishImageName").on('change', function() {
                let formData = new FormData();
                let files = $("#dishImageName").get(0).files;
                if (files.length > 0) {
                    formData.append("imageName", files[0]);
                }
                // $("#add-hero").prop("disabled", true);
                $.ajax({
                    type: 'POST',
                    url: 'http://localhost:3000/uploadimage',
                    contentType: false,
                    cache: false,
                    processData: false,
                    data: formData,
                    success: function(data) {
                        imageFile = data.filename;
                        // $("#add-hero").prop("disabled", false);
                    },
                    error: function() {
                        alert("Image upload failed!");
                    }
                });
            });
            $('#AddDish').click(function(e) {
                e.preventDefault();
                var dishName = $("#dishName").val();
                var Category = $("#Category").val();
                var Price = $("#Price").val();
                var data = {
                    'dishImageName': imageFile,
                    'dishName': dishName,
                    'Category': Category,
                    'Price': Price
                };

                $.ajax({
                    type: 'POST',
                    url: 'http://localhost:3000/addDish',
                    data: data,
                    success: function(res, textStatus, xhr) {
                        alert("New Dish Added to the Menu Successfully");
                        location.href = "productAdd.html";
                        imageFile = ''
                    },
                    error: function(xhr, textStatus, errorThrown) {
                        alert(errorThrown);
                        console.log('Error in Operation');
                    }
                });
            });
            //var tok = localStorage.getItem('token');
            //alert(tok)		
        });
    </script>
    <title>Add Dish</title>

</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light ftco_navbar bg-light ftco-navbar-light">
        <a class="navbar-brand" href="index.html">Bakery Cafe & Shop</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
				  <span class="navbar-toggler-icon"></span>
				</button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a class="nav-link" href="index.html">Home</a>
                </li>
                <li class="nav-item active">
                    <a class="nav-link" href="productAdd.html">Add new Product <span class="sr-only">(current)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="tableAdd.html">Add new Table</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					   Services
					 </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                        <a class="dropdown-item" href="viewProduct.html">Dish Menu Settings</a>
                        <a class="dropdown-item" href="tableDetail.html">Reservations</a>
                        <a class="dropdown-item" href="userDetail.html">List of Users</a>
                        <a class="dropdown-item" href="reviewQuestion.html">Reviews</a>
                    </div>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="clientOrder.html">List of Orders</a>
                </li>
            </ul>
            <form class="form-inline my-2 my-lg-0">
                <button id="logout" class="btn btn-outline-success my-2 my-sm-0" type="submit">LogOut</button>
            </form>
        </div>
    </nav>
    <!-- End of nav-bar -->

    <div class="container">
        <div class="row">
            <div class="card card-container col-md-8 p-5 ml-md-5">
                <form class="form" enctype="multipart/form-data">
                    <div class="text-center">
                        <h1><label class="alert bg-secondary text-white">Add Dish</label></h1><br />
                    </div>

                    <label class="labes text-dark">Choose Image:</label><br />
                    <input class="btn btn-primary btn-lg" class="form-control" type="file" name="dishImageName" id="dishImageName" /><br />

                    <label class="labes text-dark">Name of Dish:</label><br />
                    <input type="text" class="form-control" name="dishName" id="dishName" placeholder="Name of dish" required autofocus>

                    <label class="labes text-dark">Category of Dish:</label><br />
                    <input type="text" class="form-control" name="Category" id="Category" placeholder="Category of Dish" required autofocus>

                    <label class="labes text-dark">Price of Dish:</label><br />
                    <input type="text" class="form-control" name="Price" id="Price" placeholder="Price of Dish" required autofocus>

                    </br>

                    <button id="AddDish" class="btn btn-lg btn-primary" type=Submit value="Submit">Add Dish</button>
                    <br/>
                    <a type="button" class="btn btn-danger" href="viewProduct.html">
                        <font size="3"></font>Want To View The List Of Dish? </font>
                    </a>
                </form>


            </div>
        </div>

    </div>

</body>

</html>